!function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e){if("string"!=typeof e)return!1;var t=document.getElementById("version");if(t)return"N/A"===e?t.innerHTML="San detected, unknown version.":t.innerHTML="San <b>"+e+"</b> detected.",document.querySelector("a img").style.filter="none",t.innerHTML+="<br />Please open devtools and click San panel for the detail.",u.sendMessage("background:version_visibility",{from:"popup:detector",versionVisibility:!1,version:e}),!0}var o=n(2),s=(r(o),n(1)),a=r(s),c=new a.default,u=c.initConnection("detector",function(e,t,n,r){i(e)}),p={};setTimeout(function(){u.sendMessage("content_script:san_version",{from:"popup:detector"}).then(function(e){i(e)}),u.sendMessage("background:options",{}).then(function(e){p=e,document.querySelector("#no_version_shown").checked=!!+p.do_not_show_version})},100),window.addEventListener("load",function(e){document.querySelector("#no_version_shown").addEventListener("click",function(e){u.sendMessage("background:options",{do_not_show_version:e.target.checked?1:0})})})},function(e,t,n){!function(t,n){e.exports=n()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";var r=n(1),i=n(6),o=n(2),s=n(5),a=function(){o.constructorTweakMethods("Messenger",this),this._myExtPart=o.getCurrentExtensionPart()};a.prototype.constructor=a,a.isMessengerPort=function(e){return 0===e.name.indexOf(s.MESSENGER_PORT_NAME_PREFIX)},a.prototype.initBackgroundHub=function(e){return this._myExtPart!==s.BACKGROUND?void o.log("warn","[Messenger:initBackgroundHub]","Ignoring BackgroundHub init request since not called from background context"):this._backgroundHub?void o.log("warn","[Messenger:initBackgroundHub]","Ignoring BackgroundHub init request since it is already been inited"):void(this._backgroundHub=new r(e))},a.prototype.initConnection=function(e,t){return e||o.log("error","[Messenger:initConnection]",'Missing "name" in arguments'),e===s.TO_NAME_WILDCARD&&o.log("error","[Messenger:initConnection]",'"*" is reserved as a wildcard identifier, please use another name'),new i(this._myExtPart,e,t)},e.exports=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(5),o=1,s=function(e){r.constructorTweakMethods("BackgroundHub",this),e=e||{},this._connectedHandler=e.connectedHandler,this._disconnectedHandler=e.disconnectedHandler,this._backgroundPorts={},this._contentScriptPorts={},this._popupPorts={},this._devtoolPorts={},chrome.runtime.onConnect.addListener(this._onPortConnected),window.mockPortOnConnect=this._onPortConnected};s.prototype.constructor=s,s.prototype._onPortConnected=function(e){r.log("log","[BackgroundHub:runtime.onConnect]",arguments),0===e.name.indexOf(i.MESSENGER_PORT_NAME_PREFIX)&&(e.onMessage.addListener(this._onPortMessageHandler),e.onDisconnect.addListener(this._onPortDisconnectionHandler))},s.prototype._onPortMessageHandler=function(e,t){switch(e.type){case i.INIT:this._initConnection(e,t);break;case i.MESSAGE:case i.RESPONSE:e.to||r.log("error","[BackgroundHub:_onPortMessageHandler]",'Missing "to" in message:',e),e.toNames||r.log("error","[BackgroundHub:_onPortMessageHandler]",'Missing "toNames" in message:',e),this._relayMessage(e,t);break;default:r.log("error","[BackgroundHub:_onPortMessageHandler]","Unknown message type: "+e.type)}},s.prototype._getPortsObj=function(e){switch(e){case i.BACKGROUND:return this._backgroundPorts;case i.CONTENT_SCRIPT:return this._contentScriptPorts;case i.POPUP:return this._popupPorts;case i.DEVTOOL:return this._devtoolPorts;default:r.log("error","[BackgroundHub:_onPortDisconnectionHandler]","Unknown extension part: "+e)}},s.prototype._initConnection=function(e,t){var n=function(e,n){var o=this._getPortsObj(e);if(o[n]=o[n]?o[n]:[],o[n].push(t),this._connectedHandler){var s=e!==i.BACKGROUND?n:null,a=r.removeMessengerPortNamePrefix(t.name);this._connectedHandler(e,a,s)}t.postMessage({from:i.BACKGROUND,type:i.INIT_SUCCESS})}.bind(this);if(e.from===i.BACKGROUND)n(i.BACKGROUND,o);else if(e.from===i.DEVTOOL)n(i.DEVTOOL,e.tabId);else if(e.from===i.CONTENT_SCRIPT)n(i.CONTENT_SCRIPT,t.sender.tab.id);else{if(e.from!==i.POPUP)throw new Error('Unknown "from" in message: '+e.from);n(i.POPUP,e.tabId)}},s.prototype._relayMessage=function(e,t){var n=e.from,s=e.to,a=e.toNames,c=e.toTabId,u=void 0;n===i.BACKGROUND?s!==i.BACKGROUND&&(u=c):n===i.DEVTOOL?u=e.tabId:n===i.POPUP?u=e.tabId:n===i.CONTENT_SCRIPT?u=t.sender.tab.id:r.log("error","[BackgroundHub:_relayMessage]",'Unknown "from" in message: '+n),e.fromTabId=u;var p=void 0;s===i.BACKGROUND?p=this._backgroundPorts[o]?this._backgroundPorts[o]:[]:s===i.DEVTOOL?p=this._devtoolPorts[u]?this._devtoolPorts[u]:[]:s===i.POPUP?p=this._popupPorts[u]?this._popupPorts[u]:[]:s===i.CONTENT_SCRIPT?p=this._contentScriptPorts[u]?this._contentScriptPorts[u]:[]:r.log("error","[BackgroundHub:_relayMessage]",'Unknown "to" in message: '+s),0===p.length&&r.log("info","[BackgroundHub:_relayMessage]",'Not sending relay because "to" port does not exist');var l=[];a.forEach(function(e){var t=p.filter(function(t){return t.name===e||e===i.TO_NAME_WILDCARD});t.length>0?t.forEach(function(e){l.indexOf(e)===-1&&l.push(e)}):r.log("warn","[BackgroundHub:_relayMessage]","could not find any connections with this name (probably no such name):",r.removeMessengerPortNamePrefix(e))}.bind(this)),e.fromPortSender=t.sender,l.forEach(function(t){t.postMessage(e)}.bind(this))},s.prototype._onPortDisconnectionHandler=function(e){e.onMessage.removeListener(this._onPortMessageHandler);var t=function(e,t){for(var n=this._getPortsObj(e),o=Object.keys(n),s=0;s<o.length;s++){for(var a=o[s],c=n[a],u=c.length,p=u;p>=0;p--){var l=c[p];if(l===t&&(r.log("log","[BackgroundHub:_onPortDisconnectionHandler]","remove connection of port with unique id: ",a),c.splice(p,1),this._disconnectedHandler)){var h=e!==i.BACKGROUND?parseInt(a):null,d=r.removeMessengerPortNamePrefix(t.name);this._disconnectedHandler(e,d,h)}}0===n[a].length&&(r.log("log","[BackgroundHub:_onPortDisconnectionHandler]","removing empty ports object for unique id: ",a),delete n[a])}}.bind(this);t(i.BACKGROUND,e),t(i.CONTENT_SCRIPT,e),t(i.POPUP,e),t(i.DEVTOOL,e)},t.default=s,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),i=n(5),o=new r({prefix:"messenger-log",markdown:!1}),s=new r({prefix:"messenger-info",markdown:!1}),a=new r({prefix:"messenger-warn",markdown:!1}),c=new r({prefix:"messenger-error",markdown:!1});r.disable("messenger*","-messenger-error","-messenger-warn");var u={log:function(e){var t=Array.prototype.slice.call(arguments,1);switch(e){case"log":o.log.apply(o,t);break;case"info":s.info.apply(s,t);break;case"warn":a.warn.apply(a,t);break;case"error":throw c.error.apply(c,t),"Messenger error occurred, check more information above...";default:c.error("Unknown log level: "+e)}},constructorTweakMethods:function(e,t){var n=function(n){var r=t[n];t[n]=function(){return o.log("["+e+":"+n+"()]",arguments),r.apply(t,arguments)}.bind(t)};for(var r in t)"function"==typeof t[r]&&n(r)},getCurrentExtensionPart:function(){var e=void 0;if("undefined"!=typeof chrome)if(chrome.devtools)e=i.DEVTOOL;else if(chrome.extension&&"function"==typeof chrome.extension.getBackgroundPage){var t=chrome.extension.getBackgroundPage();e=t===window?i.BACKGROUND:i.POPUP}else e=i.CONTENT_SCRIPT;else c.error("Could not identify extension part... are you running in a chrome extension context?");return o.log("detected current extension part: "+e),e},removeMessengerPortNamePrefix:function(e){return e.replace(new RegExp("^"+i.MESSENGER_PORT_NAME_PREFIX),"")}};t.default=u,e.exports=t.default},function(e,t,n){(function(t){!function(){"use strict";function n(e){if(!(this instanceof n))return new n(e);e=e||{};var t=void 0===e.prefix?"":e.prefix;return t=h(t),t&&p(t,v)?l(t,v):(this.alignOutput=Boolean(e.alignOutput),this.markdown=void 0===e.markdown||e.markdown,this.prefix=t,v.push(this),r(v),g()?(this.prefixColor=y[m%y.length],m+=1):f()&&(this.prefixColor=E()),this)}function r(e){var t=e.sort(function(e,t){return t.prefix.length-e.prefix.length})[0];e.forEach(function(e){if(e.alignOutput){var n=new Array(Math.max(t.prefix.length-e.prefix.length+1,0)).join(" ");e.prefix=e.prefix+n}})}function i(e){for(var t=[],n=o(e);n;)e=e.replace(n.rule.regexp,n.rule.replacer),g()&&(t.push(n.rule.style),t.push("")),n=o(e);return{text:e,styles:t}}function o(e){var t=[],n=[];return g()?n=[{regexp:/\*([^\*]+)\*/,replacer:function(e,t){return"%c"+t+"%c"},style:"font-weight:bold;"},{regexp:/_([^_]+)_/,replacer:function(e,t){return"%c"+t+"%c"},style:"font-style:italic;"},{regexp:/`([^`]+)`/,replacer:function(e,t){return"%c"+t+"%c"},style:"background:#FDF6E3; color:#586E75; padding:1px 5px; border-radius:4px;"}]:f()&&(n=[{regexp:/\*([^\*]+)\*/,replacer:function(e,t){return"["+_.modifiers.bold[0]+"m"+t+"["+_.modifiers.bold[1]+"m"}},{regexp:/_([^_]+)_/,replacer:function(e,t){return"["+_.modifiers.italic[0]+"m"+t+"["+_.modifiers.italic[1]+"m"}},{regexp:/`([^`]+)`/,replacer:function(e,t){return"["+_.bgColors.bgYellow[0]+"m["+_.colors.black[0]+"m "+t+" ["+_.colors.black[1]+"m["+_.bgColors.bgYellow[1]+"m"}}]),n.forEach(function(n){var r=e.match(n.regexp);r&&t.push({rule:n,match:r})}),0===t.length?null:(t.sort(function(e,t){return e.match.index-t.match.index}),t[0])}function s(e,t){var n,r=[];return t.prefix?d()?(r.push("%c"+t.prefix+"%c "),r.push("color:"+t.prefixColor+"; font-weight:bold;","")):r.push("["+t.prefix+"] "):r.push(""),"string"==typeof e[0]?t.markdown&&d()?(n=i(e[0]),r[0]=r[0]+n.text,r=r.concat(n.styles)):r[0]=r[0]+e[0]:r[0]=e[0],e.length>1&&(r=r.concat(e.splice(1))),r}function a(e,t,n){var r=[];return n.prefix&&(d()?r[0]="["+n.prefixColor[0]+"m["+_.modifiers.bold[0]+"m"+n.prefix+"["+_.modifiers.bold[1]+"m["+n.prefixColor[1]+"m":r[0]="["+n.prefix+"]"),"warn"===t?r[0]="["+_.colors.yellow[0]+"m⚠["+_.colors.yellow[1]+"m "+(r[0]||""):"error"===t?r[0]="["+_.colors.red[0]+"m✖["+_.colors.red[1]+"m "+(r[0]||""):"info"===t?r[0]="["+_.colors.blue[0]+"mℹ["+_.colors.blue[1]+"m "+(r[0]||""):"debug"===t&&(r[0]="["+_.colors.gray[0]+"m🐛["+_.colors.gray[1]+"m "+(r[0]||"")),e.forEach(function(e){"string"==typeof e&&n.markdown?r.push(i(e).text):r.push(e)}),r}function c(e){var r=null;"undefined"!=typeof t&&void 0!==t.env&&0===w.length&&(void 0!==t.env.NODE_DEBUG&&""!==t.env.NODE_DEBUG?r="NODE_DEBUG":void 0!==t.env.DEBUG&&""!==t.env.DEBUG&&(r="DEBUG"),r&&(n.disable("*"),t.env[r].split(",").forEach(function(e){n.enable(e)})));var i=!1;return w.forEach(function(t){"enable"===t.type&&t.regExp.test(e.prefix)?i=!1:"disable"===t.type&&t.regExp.test(e.prefix)&&(i=!0)}),i}function u(e){return new RegExp("^"+e.replace(/\*/g,".*?")+"$")}function p(e,t){var n=!1;return t.forEach(function(t){if(t.prefix===e)return void(n=!0)}),n}function l(e,t){var n;return t.forEach(function(t){if(t.prefix===e)return void(n=t)}),n}function h(e){return"string"==typeof e?e.replace(/%c/g,""):e}function d(){if(g()){var e="WebkitAppearance"in document.documentElement.style,n=window.console&&(console.firebug||console.exception&&console.table),r=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31;return e||n||r}if(f())return!(t.stdout&&!t.stdout.isTTY)&&("win32"===t.platform||"COLORTERM"in t.env||"dumb"!==t.env.TERM&&!!/^screen|^xterm|^vt100|color|ansi|cygwin|linux/i.test(t.env.TERM))}function f(){return"undefined"!=typeof e&&"undefined"!=typeof e.exports}function g(){return"undefined"!=typeof window}var v=[],m=0,y=["#B58900","#CB4B16","#DC322F","#D33682","#6C71C4","#268BD2","#2AA198","#859900"],_={modifiers:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},colors:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],gray:[90,39]},bgColors:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49]}},w=[];n.enable=function(){Array.prototype.forEach.call(arguments,function(e){"-"===e[0]&&n.disable(e.substr(1));var t=u(e);"*"===e?w=[]:w.push({type:"enable",regExp:t})})},n.disable=function(){Array.prototype.forEach.call(arguments,function(e){"-"===e[0]&&n.enable(e.substr(1));var t=u(e);"*"===e?w=[{type:"disable",regExp:t}]:w.push({type:"disable",regExp:t})})};var x=["debug","log","info","warn","error"];x.forEach(function(e){n.prototype[e]=function(){if(!c(this)){var t,n=Array.prototype.slice.call(arguments,0);g()?(t=s(n,this),Function.prototype.apply.call(console[e]||console.log,console,t)):f()&&(t=a(n,e,this),(console[e]||console.log).apply(console,t))}}});var E=function(){var e=0,t=[[31,39],[32,39],[33,39],[34,39],[35,39],[36,39]];return function(){return t[(e+=1)%t.length]}}();f()?e.exports=n:g()&&(window.Logdown=n)}()}).call(t,n(4))},function(e,t){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function i(e){if(p===setTimeout)return setTimeout(e,0);if((p===n||!p)&&setTimeout)return p=setTimeout,setTimeout(e,0);try{return p(e,0)}catch(t){try{return p.call(null,e,0)}catch(t){return p.call(this,e,0)}}}function o(e){if(l===clearTimeout)return clearTimeout(e);if((l===r||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(e);try{return l(e)}catch(t){try{return l.call(null,e)}catch(t){return l.call(this,e)}}}function s(){g&&d&&(g=!1,d.length?f=d.concat(f):v=-1,f.length&&a())}function a(){if(!g){var e=i(s);g=!0;for(var t=f.length;t;){for(d=f,f=[];++v<t;)d&&d[v].run();v=-1,t=f.length}d=null,g=!1,o(e)}}function c(e,t){this.fun=e,this.array=t}function u(){}var p,l,h=e.exports={};!function(){try{p="function"==typeof setTimeout?setTimeout:n}catch(e){p=n}try{l="function"==typeof clearTimeout?clearTimeout:r}catch(e){l=r}}();var d,f=[],g=!1,v=-1;h.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];f.push(new c(e,t)),1!==f.length||g||i(a)},c.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=u,h.addListener=u,h.once=u,h.off=u,h.removeListener=u,h.removeAllListeners=u,h.emit=u,h.binding=function(e){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(e){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={MESSENGER_PORT_NAME_PREFIX:"__messenger__",TO_NAME_WILDCARD:"*",BACKGROUND:"background",POPUP:"popup",DEVTOOL:"devtool",CONTENT_SCRIPT:"content_script",INIT:"init",INIT_SUCCESS:"init_success",MESSAGE:"message",RESPONSE:"response"};t.default=n,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(7),i=n(2),o=n(5),s=500,a=1e5,c=5e3,u=function(e,t,n){i.constructorTweakMethods("Connection",this),this._init(e,t,n)};u.prototype.constructor=u,u.prototype._init=function(e,t,n){switch(this._port=null,this._inited=!1,this._pendingInitMessages=[],this._pendingCb={},this._cbId=0,this._pendingCbCleanupIndex=0,this._myExtPart=e,this._myName=o.MESSENGER_PORT_NAME_PREFIX+t,this._userMessageHandler=n||function(){},this._myExtPart){case o.BACKGROUND:case o.CONTENT_SCRIPT:case o.POPUP:case o.DEVTOOL:var a=function(e){i.log("log","[Connection:_init]","Attempting connection initing..."),this._port=this._myExtPart===o.BACKGROUND?new r({name:this._myName}):chrome.runtime.connect({name:this._myName}),this._port.onMessage.addListener(this._onPortMessageHandler),this._port.postMessage({type:o.INIT,from:this._myExtPart,tabId:e});var t=arguments,n=setTimeout(function(){this._inited?clearTimeout(n):(this._port.disconnect(),a.apply(this,t))}.bind(this),s)}.bind(this);switch(this._myExtPart){case o.BACKGROUND:case o.CONTENT_SCRIPT:a();break;case o.POPUP:chrome.tabs.query({active:!0,currentWindow:!0},function(e){a(e[0].id)});break;case o.DEVTOOL:a(chrome.devtools.inspectedWindow.tabId)}break;default:i.log("error","[Connection:_init]","Unknown extension part: "+e)}},u.prototype._attemptDeadCbCleanup=function(){if(Object.keys(this._pendingCb).length>a){i.log("log","[Connection:_attemptDeadCbCleanup]","attempting dead callback cleaning... current callbacks number:".Object.keys(this._pendingCb).length);for(var e=this._pendingCbCleanupIndex+c;this._pendingCbCleanupIndex<e;)delete this._pendingCb[this._pendingCbCleanupIndex],this._pendingCbCleanupIndex++;i.log("log","[Connection:_attemptDeadCbCleanup]","new callbacks number after cleaning done:",Object.keys(this._pendingCb).length)}},u.prototype._prepareMessage=function(e,t){var n=this;return new Promise(function(r){switch(t&&(n._cbId++,n._pendingCb[n._cbId]=t,e.cbId=n._cbId,n._attemptDeadCbCleanup()),n._myExtPart){case o.DEVTOOL:e.tabId=chrome.devtools.inspectedWindow.tabId,r();break;case o.POPUP:chrome.tabs.query({active:!0,currentWindow:!0},function(t){e.tabId=t[0].id,r()}.bind(n));break;default:r()}})},u.prototype._postMessage=function(e,t,n){var r=this;this._prepareMessage(t,n).then(function(){r._inited?e.postMessage(t):r._pendingInitMessages.push(t)})},u.prototype._postResponse=function(e,t,n){var r={from:this._myExtPart,to:n.from,toNames:[n.fromName],type:o.RESPONSE,cbId:n.cbId,cbValue:t};this._myExtPart===o.BACKGROUND&&(r.toTabId=n.fromTabId),this._postMessage(e,r)},u.prototype._handleMessage=function(e,t){var n=function(n){e.cbId&&this._postResponse(t,n,e)}.bind(this),r=i.removeMessengerPortNamePrefix(e.fromName),s=e.fromTabId&&e.from!==o.BACKGROUND?":"+e.fromTabId:null,a=e.from+":"+r+(s?":"+s:"");this._userMessageHandler(e.userMessage,a,e.fromPortSender,n)},u.prototype._handleResponse=function(e){if(this._pendingCb[e.cbId]){var t=this._pendingCb[e.cbId];delete this._pendingCb[e.cbId],t(e.cbValue)}else i.log("info","[Connection:_handleResponse]","ignoring response sending because callback does not exist (probably already been called)")},u.prototype._sendMessage=function(e,t,n,r,i,s){n=this._addMessengerPortNamePrefix(n);var a={from:this._myExtPart,fromName:this._myName,to:t,toNames:n,toTabId:r,type:o.MESSAGE,userMessage:i};this._postMessage(e,a,s)},u.prototype._addMessengerPortNamePrefix=function(e){return e.map(function(e){return e===o.TO_NAME_WILDCARD?e:o.MESSENGER_PORT_NAME_PREFIX+e})},u.prototype._validateMessage=function(e,t,n){if(!e)return'Missing extension part in "to" argument';if(e!==o.BACKGROUND&&e!==o.CONTENT_SCRIPT&&e!==o.DEVTOOL&&e!==o.POPUP)return'Unknown extension part in "to" argument: '+e+"\nSupported parts are: "+o.BACKGROUND+", "+o.CONTENT_SCRIPT+", "+o.POPUP+", "+o.DEVTOOL;if(!t)return'Missing connection name in "to" argument';if(this._myExtPart===o.BACKGROUND&&e!==o.BACKGROUND){if(!n)return'Messages from background to other extension parts must have a tab id in "to" argument';if(!Number.isInteger(parseFloat(n)))return"Tab id to send message to must be a valid number"}},u.prototype._onPortMessageHandler=function(e,t){switch(e.type){case o.INIT_SUCCESS:this._inited=!0,this._pendingInitMessages.forEach(function(e){this._port.postMessage(e)}.bind(this));break;case o.MESSAGE:case o.RESPONSE:e.to||i.log("error","[Connection:_onPortMessageHandler]",'Missing "to" in message: ',e),e.toNames||i.log("error","[Connection:_onPortMessageHandler]",'Missing "toNames" in message: ',e),e.type===o.MESSAGE?this._handleMessage(e,t):e.type===o.RESPONSE&&this._handleResponse(e);break;default:i.log("error","[Connection:_onPortMessageHandler]","Unknown message type: "+e.type)}},u.prototype.sendMessage=function(e,t){var n=this,r=arguments;return new Promise(function(o){if(e||i.log("error","[Connection:sendMessage]",'missing "to" arguments'),n._port){var s=void 0;try{s=e.split(":")}catch(t){i.log("error","[Connection:sendMessage]",'Invalid format given in "to" argument: '+e,r)}var a=s[0],c=s[1],u=s[2],p=n._validateMessage(a,c,u);p&&i.log("error","[Connection:sendMessage]",p,r);var l=c.split(",");n._sendMessage(n._port,a,l,u,t,o)}else i.log("warn","[Connection:sendMessage]","ignoring sending message because connection does not exist anymore, did you disconnected it?")})},u.prototype.disconnect=function(){this._port&&(this._port.disconnect(),this._port=null)},t.default=u,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=function(e){r.constructorTweakMethods("MockPort",this);var t=this._createMockPort(e),n=this._createMockPort(e);return this._linkMocks(t,n),"function"==typeof window.mockPortOnConnect&&window.mockPortOnConnect(n),t};i.prototype.constructor=i,i.prototype._createMockPort=function(e){var t={_connected:!0,_name:e.name,onMessageListeners:[],onDisconnectListeners:[]};return Object.defineProperty(t,"name",{get:function(){return t._name}}),Object.defineProperty(t,"onMessage",{get:function(){return{addListener:function(e){t.onMessageListeners.push(e)},removeListener:function(e){var n=t.onMessageListeners.indexOf(e);n!==-1&&t.onMessageListeners.splice(n,1)}}}}),Object.defineProperty(t,"onDisconnect",{get:function(){return{addListener:function(e){t.onDisconnectListeners.push(e)},removeListener:function(e){var n=t.onDisconnectListeners.indexOf(e);n!==-1&&t.onDisconnectListeners.splice(n,1)}}}}),Object.defineProperty(t,"sender",{get:function(){return{id:chrome.runtime.id}}}),t.postMessage=function(e){t._connected?t.__targetRefPort?t.__targetRefPort.__invokeOnMessageHandlers(e):r.log("warn","[MockPort:postMessage]","Missing __targetRefPort",arguments):r.log("warn","[MockPort:postMessage]","Attempting to post message on a disconnected mock port",e)},t.disconnect=function(){t._connected=!1,t.__targetRefPort?t.__targetRefPort.__invokeOnDisconnectHandlers():r.log("warn","[MockPort:postMessage]","Missing __targetRefPort",arguments),t._onMessageListeners=[],t._onDisconnectListeners=[]},t.__invokeOnMessageHandlers=function(e){t.onMessageListeners.forEach(function(n){n(e,t)})},t.__invokeOnDisconnectHandlers=function(){t.onDisconnectListeners.forEach(function(e){e(t)})},t},i.prototype._linkMocks=function(e,t){e.__targetRefPort=t,t.__targetRefPort=e},t.default=i,e.exports=t.default}])})},function(e,t,n){(function(n){!function(r){function i(){}function o(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function s(e,t){var n=e.prototype,r=new Function;r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e,o(e.prototype,n)}function a(e,t){var n=Function.prototype.bind,r=Array.prototype.slice;if(n&&e.bind===n)return n.apply(e,r.call(arguments,1));var i=r.call(arguments,2);return function(){return e.apply(t,i.concat(r.call(arguments)))}}function c(e,t,n){if(e&&e.length>0){n&&(t=a(t,n));for(var r=0,i=e.length;r<i&&t(e[r],r)!==!1;r++);}}function u(e,t){var n=!1;return c(e,function(e){return n=e===t,!n}),n}function p(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)}function l(e,t,n){e.addEventListener?e.removeEventListener(t,n,!1):e.detachEvent("on"+t,n)}function h(e){return Ve[e]?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e)}function d(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function f(){return"_san_"+Ke++}function g(e,t){if(t&&(e=a(e,t)),Ye.push(e),!We)if(We=function(){var e=Ye.slice(0);Ye=[],We=null,c(e,function(e){e()})},"function"==typeof MutationObserver){var r=1,i=new MutationObserver(We),o=document.createTextNode(r);i.observe(o,{characterData:!0}),o.data=++r}else"function"==typeof n?n(We):setTimeout(We,0)}function v(){this.raw=ze?[]:"",this.length=0}function m(){this.raw=[],this.index={}}function y(e){return e&&1===e.nodeType?"element":Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function _(e){var t=function(){};t.isRequired=i;var n=function(t,n,r,i,o){var s=n[r],a=y(s);if(i=i||Qe,null!=s)e(n,r,i,o);else if(t)throw new Error("[SAN ERROR] The `"+r+"` is marked as required in `"+i+"`, but its value is "+a)};return t=a(n,null,!1),t.isRequired=a(n,null,!0),t}function w(e){return _(function(t,n,r,i){var o=t[n],s=y(o);if(s!==e)throw new Error("[SAN ERROR] Invalid "+r+" data `"+i+"` of type("+s+" supplied to "+r+", expected "+e+")")})}function x(e){return _(function(t,n,r,i){if("function"!=typeof e)throw new Error("[SAN ERROR] Data `"+n+"` of `"+r+"` has invalid DataType notation inside `arrayOf`, expected `function`");var o=t[n],s=y(o);if("array"!==s)throw new Error("[SAN ERROR] Invalid "+r+" data `"+i+"` of type("+s+" supplied to "+r+", expected array)");for(var a=0,c=o.length;a<c;a++)e(o,a,r,i+"["+a+"]")})}function E(e){return _(function(t,n,r,i){var o=t[n];if(!(o instanceof e)){var s=o.constructor&&o.constructor.name?o.constructor.name:Qe,a=e.name||Qe;throw new Error("[SAN ERROR] Invalid "+r+" data `"+i+"` of type("+s+" supplied to "+r+", expected instance of "+a+")")}})}function b(e){return _(function(t,n,r,i){if("object"!==y(e))throw new Error("[SAN ERROR] Data `"+i+"` of `"+r+"` has invalid DataType notation inside `shape`, expected `object`");var o=t[n],s=y(o);if("object"!==s)throw new Error("[SAN ERROR] Invalid "+r+" data `"+i+"` of type("+s+" supplied to "+r+", expected object)");for(var a in e)if(e.hasOwnProperty(a)){var c=e[a];"function"==typeof c&&c(o,a,r,i+"."+a)}})}function N(e){return _(function(t,n,r,i){if("array"!==y(e))throw new Error("[SAN ERROR] Data `"+i+"` of `"+r+"` has invalid DataType notation inside `oneOf`, array is expected.");for(var o=t[n],s=0,a=e.length;s<a;s++)if(o===e[s])return;throw new Error("[SAN ERROR] Invalid "+r+" data `"+i+"` of value(`"+o+"` supplied to "+r+", expected one of "+e.join(",")+")")})}function C(e){return _(function(t,n,r,i){if("array"!==y(e))throw new Error("[SAN ERROR] Data `"+n+"` of `"+r+"` has invalid DataType notation inside `oneOf`, array is expected.");for(var o=t[n],s=0,a=e.length;s<a;s++){var c=e[s];if("function"==typeof c)try{return void c(t,n,r,i)}catch(e){}}throw new Error("[SAN ERROR] Invalid "+r+" data `"+n+"` of value(`"+o+"` supplied to "+r+")")})}function T(e){return _(function(t,n,r,i){if("function"!=typeof e)throw new Error("[SAN ERROR] Data `"+n+"` of `"+r+"` has invalid DataType notation inside `objectOf`, expected function");var o=t[n],s=y(o);if("object"!==s)throw new Error("[SAN ERROR] Invalid "+r+" data `"+n+"` of type("+s+" supplied to "+r+", expected object)");for(var a in o)o.hasOwnProperty(a)&&e(o,a,r,i+"."+a)})}function R(e){return _(function(t,n,r,i,s){if("object"!==y(e))throw new Error("[SAN ERROR] Data `"+n+"` of `"+r+"` has invalid DataType notation inside `exact`");var a=t[n],c=y(a);if("object"!==c)throw new Error("[SAN ERROR] Invalid data `"+i+"` of type `"+c+"`(supplied to "+r+", expected `object`)");var u={};o(u,e),o(u,a);for(var p in u)if(u.hasOwnProperty(p)){var l=e[p];if(!l)throw new Error("[SAN ERROR] Invalid data `"+i+"` key `"+p+"` supplied to `"+r+"`. (`"+p+"` is not defined in `DataTypes.exact`)");if(!(p in a))throw new Error("[SAN ERROR] Invalid data `"+i+"` key `"+p+"` supplied to `"+r+"`. (`"+p+"` is marked `required` in `DataTypes.exact`)");l(a,p,r,i+"."+p,s)}})}function P(e,t){return function(n){for(var r in e)if(e.hasOwnProperty(r)){var i=e[r];if("function"!=typeof i)throw new Error("[SAN ERROR] "+t+":"+r+" is invalid; it must be a function, usually from san.DataTypes");i(n,r,t,r)}}}function O(e){this.source=e,this.len=this.source.length,this.index=0}function k(e){var t,n=e.currentCode(),r=e.index;e:for(;t=e.nextCode();)switch(t){case 92:e.go(1);break;case n:e.go(1);break e}var i=e.cut(r,e.index);return{type:et.STRING,value:new Function("return "+i)()}}function A(e){var t=e.match(/\s*(-?[0-9]+(.[0-9]+)?)/g);return{type:et.NUMBER,value:t[1]-0}}function S(e){var t=e.match(/\s*([\$0-9a-z_]+)/gi);return t[1]}function M(e){var t=F(e);if(e.goUntil(),63===e.currentCode()){e.go(1);var n=M(e);if(e.goUntil(),58===e.currentCode())return e.go(1),{type:et.TERTIARY,segs:[t,n,M(e)]}}return t}function I(e){var t=S(e);switch(t){case"true":case"false":return{type:et.BOOL,value:"true"===t}}var n={type:et.ACCESSOR,paths:[{type:et.STRING,value:t}]};e:for(;;)switch(e.currentCode()){case 46:e.go(1),n.paths.push({type:et.STRING,value:S(e)});break;case 91:e.go(1),n.paths.push(M(e)),e.goUntil(93);break;default:break e}return n}function L(e){e.go(1);var t=M(e);return e.goUntil(41),t}function D(e){switch(e.goUntil(),e.currentCode()){case 33:return e.go(1),{type:et.UNARY,expr:D(e)};case 34:case 39:return k(e);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return A(e);case 40:return L(e)}return I(e)}function U(e){var t=D(e);e.goUntil();var n=e.currentCode();switch(n){case 37:case 42:case 47:return e.go(1),{type:et.BINARY,operator:n,segs:[t,U(e)]}}return t}function B(e){var t=U(e);e.goUntil();var n=e.currentCode();switch(n){case 43:case 45:return e.go(1),{type:et.BINARY,operator:n,segs:[t,B(e)]}}return t}function H(e){var t=B(e);e.goUntil();var n=e.currentCode();switch(n){case 60:case 62:return 61===e.nextCode()&&(n+=61,e.go(1)),{type:et.BINARY,operator:n,segs:[t,H(e)]}}return t}function j(e){var t=H(e);e.goUntil();var n=e.currentCode();switch(n){case 61:case 33:if(61===e.nextCode())return n+=61,61===e.nextCode()&&(n+=61,e.go(1)),{type:et.BINARY,operator:n,segs:[t,j(e)]};e.go(-1)}return t}function G(e){var t=j(e);if(e.goUntil(),38===e.currentCode()){if(38===e.nextCode())return e.go(1),{type:et.BINARY,operator:76,segs:[t,G(e)]};e.go(-1)}return t}function F(e){var t=G(e);if(e.goUntil(),124===e.currentCode()){if(124===e.nextCode())return e.go(1),{type:et.BINARY,operator:248,segs:[t,F(e)]};e.go(-1)}return t}function V(e){e.goUntil();var t=S(e),n=[];if(e.goUntil(40))for(;!e.goUntil(41);)n.push(M(e)),e.goUntil(44);return{type:et.CALL,name:t,args:n}}function W(e){for(var t=new O(e),n=M(t),r=[];t.goUntil(124);)r.push(V(t));return{type:et.INTERP,expr:n,filters:r}}function K(e){function t(e){e&&s.push({type:et.STRING,value:e})}for(var n,r=/\{\{\s*([\s\S]+?)\s*\}\}/gi,i=new O(e),o=0,s=[];null!=(n=i.match(r));)t(i.cut(o,i.index-n[0].length)),s.push(W(n[1])),o=i.index;t(i.cut(o));var a={type:et.TEXT,segs:s,raw:e};return 1===s.length&&s[0].type===et.STRING&&(a.value=s[0].value),a}function Y(e){return e=e||{},e.isText?e.textExpr=K(e.text):(e.directives=e.directives||new m,e.props=e.props||new m,e.events=e.events||[],e.childs=e.childs||[]),e}function $(e){if("object"==typeof e&&e.type)return e;var t=M(new O(e));return t.raw=e,t}function q(e){var t=V(new O(e));return t.raw=e,t}function X(e,t,n){var r=tt[t];if(r){var i=r(n);i.name=t,i.raw=n,e.directives.push(i)}}function z(e,t,n,r){if("id"===t)return void(e.id=n);var i,o,s=t.indexOf("-");switch(s>0&&(o=t.slice(0,s),i=t.slice(s+1)),o){case"on":e.events.push({name:i,expr:q(n)});break;case"san":case"s":X(e,i,n);break;case"prop":J(e,i,n);break;default:r||J(e,t,n)}}function J(e,t,n){var r=n.match(/^\{=\s*(.*?)\s*=\}$/);if(r)return void e.props.push({name:t,expr:$(r[1]),x:1,raw:n});var i={name:t,expr:K(n),raw:n};switch(i.name){case"class":case"style":c(i.expr.segs,function(e){e.type===et.INTERP&&e.filters.push({type:et.CALL,name:"_"+i.name,args:[]})})}e.props.push(i)}function Q(e){function t(e){e&&a.childs.push(Y({isText:1,text:e,parent:a}))}var n=Y();if("string"!=typeof e)return n;e=e.replace(/<!--([\s\S]*?)-->/gm,"").replace(/(^\s+|\s+$)/g,"");for(var r,i=new O(e),o=/<(\/)?([a-z0-9-]+)\s*/gi,s=/([-:0-9a-z\(\)\[\]]+)(=(['"])([^\3]*?)\3)?\s*/gi,a=n,c=0;null!=(r=i.match(o));){var u=r[1],p=r[2].toLowerCase();if(t(e.slice(c,i.index-r[0].length)),u&&62===i.currentCode()){for(var l=a;l&&l.tagName!==p;)l=l.parent;l&&(a=l.parent),i.go(1)}else if(!u){
for(var h=Y({tagName:p,parent:a}),d=Je[p];;){var f=i.currentCode();if(62===f){i.go(1);break}if(47===f&&62===i.charCode(i.index+1)){i.go(2),d=1;break}var g=i.match(s);g&&z(h,g[1],g[2]?g[4]:"")}var v=h.directives.get("else")||h.directives.get("elif");if(v)for(var m=a.childs.length;m--;){var y=a.childs[m];{if(!y.isText){if(!y.directives.get("if"))throw new Error("[SAN FATEL] else not match if.");y.elses=y.elses||[],y.elses.push(h);break}a.childs.splice(m,1)}}else a.childs.push(h);d||(a=h)}c=i.index}return t(i.cut(c)),n}function Z(e){return rt[e]}function ee(e){return null==e?"":(""+e).replace(/[&<>"']/g,Z)}function te(e,t,n,r){if(null!=e.value)return e.value;switch(e.type){case et.UNARY:return!te(e.expr,t,n);case et.BINARY:var i=nt[e.operator];if("function"==typeof i)return i(te(e.segs[0],t,n),te(e.segs[1],t,n));return;case et.TERTIARY:return te(e.segs[te(e.segs[0],t,n)?1:2],t,n);case et.ACCESSOR:return t.get(e);case et.INTERP:var o=te(e.expr,t,n);return n&&c(e.filters,function(e){var r=e.name,i=n.filters[r]||it[r];if("function"==typeof i){var s=[o];c(e.args,function(e){s.push(te(e,t,n))}),o=i.apply(n,s)}}),null==o&&(o=""),o;case et.TEXT:var s=new v;return c(e.segs,function(e){var i=te(e,t,n);r&&e.type===et.INTERP&&!e.filters[0]&&(i=ee(i)),s.push(i)}),s.toString()}}function ne(e,t,n){var r;return c(t,function(t){return r=re(e,t,n),!r}),r?1:0}function re(e,t,n){switch(t.type){case et.ACCESSOR:for(var r=t.paths,i=r.length,o=e.paths,s=o.length,a=1,u=0;u<i;u++){var p=r[u];if(p.type===et.ACCESSOR&&re(e,p,n))return 1;a&&u<s&&te(p,n)!=te(o[u],n)&&(a=0)}return a&&(a=Math.max(1,s-i+2)),a;case et.UNARY:return re(e,t.expr,n)?1:0;case et.TEXT:case et.BINARY:case et.TERTIARY:return ne(e,t.segs,n);case et.INTERP:if(!re(e,t.expr,n)){var l;return c(t.filters,function(t){return l=ne(e,t.args,n),!l}),l?1:0}return 1}return 0}function ie(e,t){this.parent=t,this.raw=e||{},this.listeners=[]}function oe(e,t,n,r){if(0===t.length)return n;var i=te(t[0],r);if(e instanceof Array){var o=+i;if(!isNaN(o)){var s=e.slice(0);return s[o]=oe(s[o],t.slice(1),n,r),s}}else if("object"==typeof e){var s={};for(var a in e)a!==i&&(s[a]=e[a]);return s[i]=oe(e[i]||{},t.slice(1),n,r),s}return e}function se(){this.raw={}}function ae(e){return e&&"san-cmpt"===e._type}function ce(e){this.lifeCycle=new se,this.init(e||{})}function ue(e,t){t.push("<!--san:"+e.id+"-->")}function pe(e,t){return 8===e.nodeType&&e.data==="/s-"+t}function le(e){if("undefined"!=typeof window&&"undefined"!=typeof navigator&&window.document&&/^(col|colgroup|frameset|style|table|tbody|tfoot|thead|tr|select)$/i.test(e.tagName)){var t='[SAN WARNING] set html for element "'+e.tagName+'" may cause an error in old IE';if("object"!=typeof console||!console.warn)throw new Error(t);console.warn(t)}}function he(e){ce.call(this,e)}function de(e,t){var n=e.props.get("value"),r=e.props.get("type");if(n&&r)switch(r.raw){case"checkbox":return u(t,e.evalExpr(n.expr));case"radio":return t===e.evalExpr(n.expr)}}function fe(e){var t=" "+e;return{input:{attr:function(e,n,r){if(""===e.props.get(n).raw||r&&"false"!==r&&"0"!==r)return t},prop:function(t,n,r){var i=at[e]||e;t.el[i]=!(!r||"false"===r||"0"===r)}}}}function ge(e,t){var n=pt[e.tagName]||{};return n[t]||ut[t]||ct}function ve(e,t,n){var r=e.option.target;return r&&r.id===t.id&&(!n||r.prop===n)}function me(e,t,n,r){var i=[],o=e.expr;c(o.args,function(e){i.push(e.type===et.ACCESSOR&&1===e.paths.length&&"$event"===e.paths[0].value?t?r:r||window.event:te(e,n))});var s=this[o.name];"function"==typeof s&&s.apply(this,i)}function ye(e,t){e.tagName&&(t.push("<"+e.tagName+' id="'+e.id+'"'),e.props.each(function(n){var r=ae(e)?te(n.expr,e.data,e):e.evalExpr(n.expr,1);t.push(ge(e,n.name).input.attr(e,n.name,r)||"")}),t.push(">"))}function _e(e,t){var n=e.tagName;Je[n]||(t.push("</"),t.push(n),t.push(">"))}function we(e,t){if("textarea"===e.tagName){var n=e.props.get("value");n&&t.push(ee(e.evalExpr(n.expr)))}else{var r=e.aNode.directives.get("html");r?t.push(e.evalExpr(r.value)):c(e.aNode.childs,function(n){var r=Ee(n,e);r._static||(r.lifeCycle.set("painting"),e.childs.push(r)),r.genHTML(t)})}}function xe(e){this.childs=[],this.slotChilds=[],this._elFns={},ce.call(this,e)}function Ee(e,t,n){var r=ae(t)?t:t.owner;n=n||(ae(t)?t.data:t.scope);var i={aNode:e,owner:r,scope:n,parent:t};if(e.isText)return new he(i);if(e.directives.get("if"))return new Pe(i);if(e.directives.get("for"))return new Se(i);var o=r.components[e.tagName];return o?(i.subTag=e.tagName,new o(i)):"slot"===e.tagName?new Ge(i):new xe(i)}function be(e,t,n,r){var i=ae(t)?t:t.owner;r=r||(ae(t)?t.data:t.scope);var o={owner:i,scope:r,parent:t,el:e,elWalker:n};{if(8!==e.nodeType){var s=e.tagName.toLowerCase(),a=Fe(e);o.aNode=a;var c=null;s.indexOf("-")>0&&(c=i.components[s]);var u=e.getAttribute("s-component");return u&&(c=i.components[u],a.tagName=u),a.directives.get("if")?new Pe(o):a.directives.get("else")?Ne(o,"else"):a.directives.get("elif")?Ne(o,"elif"):c?new c(o):new xe(o)}var p=e.data.match(/^\s*s-([a-z]+)(:[\s\S]+)?$/);if(p)switch(o.stumpText=p[2]?p[2].slice(1):"",p[1]){case"text":return new he(o);case"for":return new Se(o);case"slot":return new Ge(o);case"if":return new Pe(o);case"else":case"elif":return void Ce(o,p[1]);case"data":var l=new Function("return "+o.stumpText.replace(/^[\s\n]*/,""))();for(var h in l)i.data.set(h,l[h]);return}}}function Ne(e,t){for(var n=e.parent.childs,r=n.length;r--;){var i=n[r];if(!(i instanceof he)){if(i instanceof Pe){i.aNode.elses||(i.aNode.elses=[]),i.aNode.elses.push(e.aNode),i.elseIndex=i.aNode.elses.length-1,e.el.removeAttribute("san-"+t),e.el.removeAttribute("s-"+t);var o=be(e.el,i,e.elWalker);i.childs[0]=o,e.aNode.childs=e.aNode.childs.slice(0);break}throw new Error("[SAN FATEL] "+t+" not match if.")}}}function Ce(e,t){for(var n=e.parent.childs,r=n.length;r--;){var i=n[r];if(!(i instanceof he)){if(i instanceof Pe){i.aNode.elses||(i.aNode.elses=[]);var o;switch(t){case"else":o=Q(e.stumpText.replace("san-else","").replace("s-else","")).childs[0],o.directives.push({value:1,name:t});break;case"elif":o=Q(e.stumpText.replace("san-elif","s-if").replace("s-elif","s-if")).childs[0];var s=o.directives.get("if");o.directives.remove("if"),s.name="elif",o.directives.push(s)}i.aNode.elses.push(o);break}throw new Error("[SAN FATEL] "+t+" not match if.")}}}function Te(e){if(e.el)return e.el.parentNode;for(var t=e.parent._getEl();t&&1!==t.nodeType;)t=t.parentNode;return t}function Re(e){if("undefined"==typeof e.el){for(var t=Te(e),n=t.firstChild;n&&(8!==n.nodeType||0!==n.data.indexOf("san:")||n.data.replace("san:","")!==e.id);)n=n.nextSibling;e.el=n}return e.el}function Pe(e){xe.call(this,e)}function Oe(e,t){var n=Y({childs:e.childs,props:e.props,events:e.events,tagName:e.tagName,directives:(new m).concat(e.directives)});return n.directives.remove("if"),n.directives.remove("else"),n.directives.remove("elif"),Ee(n,t)}function ke(e,t,n,r){ie.call(this,{},e),this.directive=t,ie.prototype.set.call(this,t.item,n),ie.prototype.set.call(this,t.index,r)}function Ae(e,t,n){var r=new ke(e.scope,e.aNode.directives.get("for"),t,n);return Ee(e.itemANode,e,r)}function Se(e){xe.call(this,e)}function Me(e,t){ht&&lt&&lt.debug&&window.__san_devtool__&&window.__san_devtool__.emit(e,t)}function Ie(e){this.dataChanges=[],this.listeners={},this.ownSlotChilds=[],xe.call(this,e)}function Le(e){function t(e){Ie.call(this,e)}if("function"==typeof e)return e;if("object"!=typeof e)throw new Error("[SAN FATAL] param must be a plain object.");return t.prototype=e,s(t,Ie),t}function De(e){this.raw=[],this.index=0;for(var t=e.firstChild;t;){switch(t.nodeType){case 1:case 8:this.raw.push(t)}t=t.nextSibling}this.current=this.raw[this.index],this.next=this.raw[this.index+1]}function Ue(e){for(var t,n=new De(e.el);t=n.current;){var r=be(t,e,n);r&&!r._static&&e.childs.push(r),n.goNext()}}function Be(e){e.each(function(e){var t=e.expr;if(t.type===et.TEXT)switch(t.segs.length){case 0:e.expr={type:et.BOOL,value:!0};break;case 1:t=e.expr=t.segs[0],t.type===et.INTERP&&0===t.filters.length&&(e.expr=t.expr)}})}function He(e){return e.replace(/-([a-z])/g,function(e,t){return t.toUpperCase()})}function je(e){var t=new m;return e.each(function(e){t.push({name:He(e.name),expr:e.expr,x:e.x,raw:e.raw})}),t}function Ge(e){this.childs=[],ce.call(this,e)}function Fe(e){var t=Y();return t.tagName=e.tagName.toLowerCase(),c(e.attributes,function(e){z(t,e.name,e.value,1)}),t}var Ve={};c("svg,g,defs,desc,metadata,symbol,use,image,path,rect,circle,line,ellipse,polyline,polygon,text,tspan,tref,textpath,marker,pattern,clippath,mask,filter,cursor,view,animate,font,font-face,glyph,missing-glyph".split(","),function(e){Ve[e]=1});var We,Ke=1,Ye=[],$e="undefined"!=typeof navigator&&navigator.userAgent.match(/msie\s*([0-9]+)/i),qe=$e?$e[1]-0:0,Xe=qe&&qe<9,ze=qe&&qe<8;v.prototype.toString=function(){return ze?this.raw.join(""):this.raw},v.prototype.push=ze?function(e){this.raw[this.length++]=e}:function(e){this.length++,this.raw+=e},m.prototype.push=function(e){if(!e.name)throw new Error('[SAN ERROR] Miss "name" property');this.index[e.name]||(this.raw.push(e),this.index[e.name]=e)},m.prototype.get=function(e){return this.index[e]},m.prototype.each=function(e,t){c(this.raw,e,t)},m.prototype.remove=function(e){this.index[e]=null;for(var t=this.raw.length;t--;)if(this.raw[t].name===e){this.raw.splice(t,1);break}},m.prototype.concat=function(e){var t=new m;return c(this.raw.concat(e.raw),function(e){t.push(e)}),t};var Je={};c("area,base,br,col,embed,hr,img,input,keygen,param,source,track,wbr".split(","),function(e){Je[e]=1});var Qe="<<anonymous>>",Ze={array:_(i),object:_(i),func:_(i),string:_(i),number:_(i),bool:_(i),symbol:_(i),any:_,arrayOf:_,instanceOf:_,shape:_,oneOf:_,oneOfType:_,objectOf:_,exact:_};Ze={any:_(i),array:w("array"),object:w("object"),func:w("function"),string:w("string"),number:w("number"),bool:w("boolean"),symbol:w("symbol"),arrayOf:x,instanceOf:E,shape:b,oneOf:N,oneOfType:C,objectOf:T,exact:R},O.prototype.currentCode=function(){return this.charCode(this.index)},O.prototype.cut=function(e,t){return this.source.slice(e,t)},O.prototype.go=function(e){this.index+=e},O.prototype.nextCode=function(){return this.go(1),this.currentCode()},O.prototype.charCode=function(e){return this.source.charCodeAt(e)},O.prototype.goUntil=function(e){for(var t;this.index<this.len&&(t=this.currentCode());)switch(t){case 32:case 9:this.index++;break;default:if(t===e)return this.index++,1;return}},O.prototype.match=function(e){e.lastIndex=this.index;var t=e.exec(this.source);return t&&(this.index=e.lastIndex),t};var et={STRING:1,NUMBER:2,BOOL:3,ACCESSOR:4,INTERP:5,CALL:6,TEXT:7,BINARY:8,UNARY:9,TERTIARY:10},tt={for:function(e){var t=new O(e),n=t.match(/^\s*([\$0-9a-z_]+)(\s*,\s*([\$0-9a-z_]+))?\s+in\s+/gi);if(n)return{item:$(n[1]),index:$(n[3]||"$index"),list:I(t)};throw new Error("[SAN FATAL] for syntax error: "+e)},ref:function(e){return{value:K(e)}},if:function(e){return{value:$(e.replace(/(^\{\{|\}\}$)/g,""))}},elif:function(e){return{value:$(e.replace(/(^\{\{|\}\}$)/g,""))}},else:function(e){return{value:1}},html:function(e){return{value:W(e)}}},nt={37:function(e,t){return e%t},43:function(e,t){return e+t},45:function(e,t){return e-t},42:function(e,t){return e*t},47:function(e,t){return e/t},60:function(e,t){return e<t},62:function(e,t){return e>t},76:function(e,t){return e&&t},94:function(e,t){return e!=t},121:function(e,t){return e<=t},122:function(e,t){return e==t},123:function(e,t){return e>=t},155:function(e,t){return e!==t},183:function(e,t){return e===t},248:function(e,t){return e||t}},rt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},it={html:ee,url:encodeURIComponent,raw:function(e){return e},_class:function(e){return e instanceof Array?e.join(" "):e},_style:function(e){if("object"==typeof e){var t="";for(var n in e)t+=n+":"+e[n]+";";return t}return e},_sep:function(e,t){return e?t+e:e}},ot={SET:1,SPLICE:2};ie.prototype.checkDataTypes=function(){this.typeChecker&&this.typeChecker(this.raw)},ie.prototype.setTypeChecker=function(e){this.typeChecker=e},ie.prototype.listen=function(e){"function"==typeof e&&this.listeners.push(e)},ie.prototype.unlisten=function(e){for(var t=this.listeners.length;t--;)e&&this.listeners[t]!==e||this.listeners.splice(t,1)},ie.prototype.fire=function(e){c(this.listeners,function(t){t.call(this,e)},this)},ie.prototype.get=function(e){var t=this.raw;if(!e)return t;e=$(e);for(var n=e.paths,r=0,i=n.length;r<i&&null!=n[r].value;r++);for(var o=0;null!=t&&o<r;o++)t=t[n[o].value];for(null==t&&this.parent&&(t=this.parent.get({type:et.ACCESSOR,paths:n.slice(0,r)})),o=r;null!=t&&o<i;o++)t=t[te(n[o],this)];return t},ie.prototype.set=function(e,t,n){n=n||{};var r=e;if(e=$(e),e.type!==et.ACCESSOR)throw new Error("[SAN ERROR] Invalid Expression in Data set: "+r);this.get(e)!==t&&(this.raw=oe(this.raw,e.paths,t,this),!n.silence&&this.fire({type:ot.SET,expr:e,value:t,option:n}),this.checkDataTypes())},ie.prototype.splice=function(e,t,n){n=n||{};var r=e;if(e=$(e),e.type!==et.ACCESSOR)throw new Error("[SAN ERROR] Invalid Expression in Data splice: "+r);var i=this.get(e),o=[];if(i instanceof Array){var s=t[0];if(s<0||s>i.length)return;var a=i.slice(0);o=a.splice.apply(a,t),this.raw=oe(this.raw,e.paths,a,this),!n.silence&&this.fire({expr:e,type:ot.SPLICE,index:s,deleteCount:o.length,value:o,insertions:t.slice(2),option:n})}return this.checkDataTypes(),o},ie.prototype.push=function(e,t,n){var r=this.get(e);r instanceof Array&&this.splice(e,[r.length,0,t],n)},ie.prototype.pop=function(e,t){var n=this.get(e);if(n instanceof Array){var r=n.length;if(r)return this.splice(e,[r-1,1],t)[0]}},ie.prototype.shift=function(e,t){return this.splice(e,[0,1],t)[0]},ie.prototype.unshift=function(e,t,n){this.splice(e,[0,0,t],n)},ie.prototype.removeAt=function(e,t,n){this.splice(e,[t,1],n)},ie.prototype.remove=function(e,t,n){var r=this.get(e);if(r instanceof Array)for(var i=r.length;i--;)if(r[i]===t){this.splice(e,[i,1],n);break}};var st={compiled:{value:1},inited:{value:2},painting:{value:3},created:{value:4,mutex:"painting"},attached:{value:5,mutex:"detached,painting"},detached:{value:6,mutex:"attached"},disposed:{value:7,mutex:"*"}};se.prototype.set=function(e){var t=this,n=st[e];n&&("*"===n.mutex?t.raw={}:n.mutex&&c(n.mutex.split(","),function(e){t.raw[st[e].value]=0}),t.raw[n.value]=1)},se.prototype.is=function(e){var t=st[e];return t&&!!this.raw[t.value]},ce.prototype._toPhase=function(e){this.lifeCycle.set(e)},ce.prototype.init=function(e){this._init(e),this._toPhase("inited")},ce.prototype._init=function(e){this.owner=e.owner,this.parent=e.parent,this.parentComponent=ae(this.parent)?this.parent:this.parent&&this.parent.parentComponent,this.scope=e.scope,this.aNode=this.aNode||e.aNode,this.el=e.el,this.id=this.el&&this.el.id||this.aNode&&this.aNode.id||f()},ce.prototype._getEl=function(){return this.el||(this.el=document.getElementById(this.id)),this.el},ce.prototype._toAttached=function(){c(this.childs,function(e){e._toAttached()}),this.lifeCycle.is("created")||this._toPhase("created"),this.lifeCycle.is("attached")||(this._attached&&this._attached(),this._toPhase("attached"))},ce.prototype.dispose=function(){this._dispose(),this._toPhase("disposed")},ce.prototype._dispose=function(){this.el=null,this.owner=null,this.scope=null,this.aNode=null,this.parent=null,this.parentComponent=null},ce.prototype.evalExpr=function(e,t){return te(e,this.scope,this.owner,t)},s(he,ce),he.prototype._init=function(e){if(ce.prototype._init.call(this,e),this.el){for(this.aNode=Y({isText:1,text:e.stumpText}),this.parent._pushChildANode(this.aNode);;){var t=e.elWalker.next;if(pe(t,"text")){e.elWalker.goNext(),d(t);break}e.elWalker.goNext()}d(this.el),this.el=null}this._static=this.aNode.textExpr.value},he.prototype.genHTML=function(e){e.push(this.evalExpr(this.aNode.textExpr,1))},he.prototype.update=function(){var e=this;this._located||(c(this.parent.childs,function(t,n){if(t===e)return e._prev=e.parent.childs[n-1],!1}),this._located=1);for(var t=this.parent._getEl(),n=e._prev&&e._prev._getEl().nextSibling||t.firstChild,r=n;r&&!/^_san_/.test(r.id);)n=r.nextSibling,d(r),r=n;le(t);var i=this.evalExpr(this.aNode.textExpr,1);n?n.insertAdjacentHTML("beforebegin",i):e._prev?e._prev._getEl().insertAdjacentHTML("afterend",i):t.innerHTML=i},he.prototype.updateView=function(e){var t=this;c(e,function(e){if(re(e.expr,t.aNode.textExpr,t.scope))return t.update(),!1})};var at={readonly:"readOnly",cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",usemap:"useMap",frameborder:"frameBorder",for:"htmlFor",class:"className"},ct={input:{attr:function(e,t,n){if(n)return" "+t+'="'+n+'"'},prop:function(e,t,n){t=at[t]||t,Ve[e.tagName]?e.el.setAttribute(t,n):e.el[t]=n}},output:function(e,t,n){n.set(t.expr,e.el[t.name],{target:{id:e.id,prop:t.name}})}},ut={style:{input:{attr:function(e,t,n){if(n)return' style="'+n+'"'},prop:function(e,t,n){e.el.style.cssText=n}}},draggable:fe("draggable"),readonly:fe("readonly"),disabled:fe("disabled")},pt={input:{mutiple:fe("mutiple"),checked:{input:{attr:function(e,t,n){if(de(e,n))return' checked="checked"'},prop:function(e,t,n){var r=de(e,n);null!=r&&(e.el.checked=r)}},output:function(e,t,n){var r=e.el,i=e.props.get("type")||{};switch(i.raw){case"checkbox":n[r.checked?"push":"remove"](t.expr,r.value);break;case"radio":r.checked&&n.set(t.expr,r.value,{target:{id:e.id,prop:t.name}})}}}},textarea:{value:{input:{attr:i,prop:ct.input.prop},output:ct.output}},option:{value:{input:{attr:function(e,t,n){for(var r=' value="'+(n||"")+'"',i=e.parent;i&&"select"!==i.tagName;)i=i.parent;if(i){var o,s,a=null;(o=i.props.get("value"))&&(s=o.expr)&&(a=ae(i)?te(s,i.data,i):i.evalExpr(s)||""),a===n&&(r+=" selected")}return r},prop:ct.input.prop}}},select:{value:{input:{attr:i,prop:function(e,t,n){e.el.value=n||""}},output:ct.output}}};s(xe,ce),xe.prototype._init=function(e){ce.prototype._init.call(this,e),this.el&&(this._initFromEl(e),this.el.id=this.id),this.tagName=this.tagName||this.aNode.tagName||"div",Xe&&this.tagName.indexOf("-")>0&&(this.tagName="div"),"option"===this.tagName&&!this.aNode.props.get("value")&&this.aNode.childs[0]&&this.aNode.props.push({name:"value",expr:this.aNode.childs[0].textExpr}),this.props=this.aNode.props,this.binds=this.aNode.binds||this.aNode.props},xe.prototype._initFromEl=function(){this.aNode=Fe(this.el),this.parent&&this.parent._pushChildANode(this.aNode),this.tagName=this.aNode.tagName,this.aNode.directives.get("html")||Ue(this)},xe.prototype._create=function(){var e=this;this.el||(e.lifeCycle.set("painting"),e.el=h(e.tagName),e.el.id=e.id,e.props.each(function(t){var n=ae(e)?te(t.expr,e.data,e):e.evalExpr(t.expr,1),r=/^\s+([a-z0-9_-]+)=(['"])([^\2]*)\2$/i.exec(ge(e,t.name).input.attr(e,t.name,n));r&&e.el.setAttribute(r[1],r[3])}))},xe.prototype.create=function(){this.lifeCycle.is("created")||(this._create(),this._toPhase("created"))},xe.prototype._attached=function(){this._initRootBindx();var e=this;c(this.aNode.events,function(t){e._onEl(t.name,a(me,ae(e)?e:e.owner,t,0,e.data||e.scope))})},xe.prototype._initRootBindx=function(){var e=this,t=ae(e)?this.props:this.binds,n=ae(e)?this.data:this.scope;t&&t.each(function(t){function r(){ge(e,t.name).output(e,t,n)}if(t.x){var i=e._getEl();switch(t.name){case"value":switch(e.tagName){case"input":case"textarea":ht&&window.CompositionEvent&&(e._onEl("compositionstart",function(){this.composing=1}),e._onEl("compositionend",function(){this.composing=0;var e=document.createEvent("HTMLEvents");e.initEvent("input",!0,!0),this.dispatchEvent(e)})),e._onEl("oninput"in i?"input":"propertychange",function(e){this.composing||r(e)});break;case"select":e._onEl("change",r)}break;case"checked":switch(e.tagName){case"input":switch(i.type){case"checkbox":case"radio":e._onEl("click",r)}}}}})},xe.prototype.attach=function(e,t){this.lifeCycle.is("attached")||(this._attach(e,t),this._toAttached())},xe.prototype._attach=function(e,t){if(this.create(),e&&(t?e.insertBefore(this.el,t):e.appendChild(this.el)),!this._contentReady){var n=new v;we(this,n);var r=n.toString();r&&(le(this.el),this.el.innerHTML=r),this._contentReady=1}},xe.prototype._onEl=function(e,t){"function"==typeof t&&(this._elFns[e]||(this._elFns[e]=[]),this._elFns[e].push(t),p(this._getEl(),e,t))},xe.prototype.genHTML=function(e){ye(this,e),we(this,e),_e(this,e)},xe.prototype.setProp=function(e,t){this.lifeCycle.is("created")&&ge(this,e).input.prop(this,e,t)},xe.prototype.updateView=function(e){this._getEl();var t=this;this.props.each(function(n){c(e,function(e){if(!ve(e,t,n.name)&&re(e.expr,n.expr,t.scope))return t.setProp(n.name,t.evalExpr(n.expr)),!1})});var n=this.aNode.directives.get("html");n?c(e,function(e){if(re(e.expr,n.value,t.scope))return le(t.el),t.el.innerHTML=t.evalExpr(n.value),!1}):this.updateChilds(e)},xe.prototype.updateChilds=function(e,t){c(this.childs,function(t){t.updateView(e)}),c(this[t||"slotChilds"],function(t){xe.prototype.updateChilds.call(t,e)})},xe.prototype.detach=function(){this.lifeCycle.is("attached")&&(this._detach(),this._toPhase("detached"))},xe.prototype._detach=function(){d(this._getEl())},xe.prototype._dispose=function(){this._disposeChilds(),this.detach();for(var e in this._elFns)for(var t=this._elFns[e],n=t&&t.length;n--;)l(this._getEl(),e,t[n]);this._elFns=null,this.childs=null,this.props=null,this.binds=null,this.slotChilds=null,ce.prototype._dispose.call(this)},xe.prototype._disposeChilds=function(){c(this.childs,function(e){e.dispose()}),this.childs.length=0},xe.prototype._pushChildANode=function(e){this.aNode.childs.push(e)},s(Pe,xe),Pe.prototype._create=function(){this.el||(this.el=document.createComment("san:"+this.id))},Pe.prototype._init=function(e){if(ce.prototype._init.call(this,e),e.el){if(8===e.el.nodeType){var t=Q(e.stumpText).childs[0];this.aNode=t}else{this.elseIndex=-1,this.el=null,this._create(),e.el.parentNode.insertBefore(this.el,e.el.nextSibling),e.el.removeAttribute("san-if"),e.el.removeAttribute("s-if");var n=be(e.el,this,e.elWalker);this.childs[0]=n,this.aNode.childs=n.aNode.childs.slice(0)}this.parent._pushChildANode(this.aNode)}this.cond=this.aNode.directives.get("if").value},Pe.prototype.genHTML=function(e){var t,n,r=this;r.evalExpr(r.cond)?(n=Oe(r.aNode,r),t=-1):c(r.aNode.elses,function(e,i){var o=e.directives.get("elif");if(!o||o&&r.evalExpr(o.value))return n=Oe(e,r),t=i,!1}),n&&(r.childs[0]=n,n.genHTML(e),r.elseIndex=t),ue(this,e)},Pe.prototype.updateView=function(e){var t,n=this,r=n.aNode;if(this.evalExpr(this.cond)?t=-1:c(n.aNode.elses,function(e,i){var o=e.directives.get("elif");if(o&&n.evalExpr(o.value)||!o)return t=i,r=e,!1}),t===n.elseIndex)n.updateChilds(e);else{if(n._disposeChilds(),"undefined"!=typeof t){var i=Oe(r,n),o=Te(n);i.attach(o,n._getEl()||o.firstChild),n.childs[0]=i}n.elseIndex=t}},Pe.prototype._getEl=function(){return Re(this)},Pe.prototype._pushChildANode=i,ke.prototype.exprResolve=function(e){function t(e){return e.type===et.ACCESSOR&&e.paths[0].value===n.item.paths[0].value?{type:et.ACCESSOR,paths:n.list.paths.concat({type:et.NUMBER,value:r.get(n.index)},e.paths.slice(1))}:e}var n=this.directive,r=this;e=t(e);var i=[];return c(e.paths,function(e){i.push(e.type===et.ACCESSOR&&e.paths[0].value===n.index.paths[0].value?{type:et.NUMBER,value:r.get(n.index)}:t(e))}),{type:et.ACCESSOR,paths:i}},s(ke,ie),c(["set","remove","unshift","shift","push","pop","splice"],function(e){ke.prototype[e]=function(t){t=this.exprResolve($(t)),this.parent[e].apply(this.parent,[t].concat(Array.prototype.slice.call(arguments,1)))}}),s(Se,xe),Se.prototype._pushChildANode=i,Se.prototype.genHTML=function(e,t){c(this.evalExpr(this.aNode.directives.get("for").list),function(t,n){var r=Ae(this,t,n);this.childs.push(r),r.genHTML(e)},this),t||ue(this,e)},Se.prototype._init=function(e){ce.prototype._init.call(this,e);var t=this.aNode;if(e.el){t=Q(e.stumpText).childs[0],this.aNode=t;for(var n=0,r=t.directives.get("for"),i=this.evalExpr(r.list)||[];;){var o=e.elWalker.next;if(pe(o,"for")){d(e.el),this.el=o,e.elWalker.goNext();break}var s=new ke(this.scope,r,i[n],n),a=be(o,this,e.elWalker,s);this.childs.push(a),n++,e.elWalker.goNext()}this.parent._pushChildANode(this.aNode)}this.itemANode=Y({childs:t.childs,props:t.props,events:t.events,tagName:t.tagName,directives:(new m).concat(t.directives)}),this.itemANode.directives.remove("for")},Se.prototype._attach=function(e,t){this.create(),e&&(t?e.insertBefore(this.el,t):e.appendChild(this.el)),this._paintList()},Se.prototype._paintList=function(){var e=Te(this),t=this._getEl()||e.firstChild,n=t&&t.previousSibling,r=new v;n?1===n.nodeType?(this.genHTML(r,1),le(e),n.insertAdjacentHTML("afterend",r.toString())):c(this.evalExpr(this.aNode.directives.get("for").list),function(n,r){var i=Ae(this,n,r);this.childs.push(i),i.attach(e,t)},this):(this.genHTML(r,1),le(e),e.insertAdjacentHTML("afterbegin",r.toString()))},Se.prototype._detach=function(){this._disposeChilds(),d(this._getEl())},Se.prototype._create=function(){this.el||(this.el=document.createComment("san:"+this.id))},Se.prototype.updateView=function(e){var t=[];c(this.childs,function(){t.push([])});var n=0,r=this.aNode.directives.get("for");if(c(e,function(e){var i=re(e.expr,r.list,this.scope);if(i){if(i>2){var s=e.expr.paths,a=r.list.paths.length;e=o({},e),e.expr={type:et.ACCESSOR,paths:r.item.paths.concat(s.slice(a+1))};var u=+this.evalExpr(s[a]);switch(t[u].push(e),e.type){case ot.SET:ie.prototype.set.call(this.childs[u].scope,e.expr,e.value,{silence:1});break;case ot.SPLICE:ie.prototype.splice.call(this.childs[u].scope,e.expr,[].concat(e.index,e.deleteCount,e.insertions),{silence:1})}}else if(e.type===ot.SET)this._disposeChilds(),n=1;else if(2===i&&e.type===ot.SPLICE){var p=e.index,l=e.deleteCount,h={type:ot.SET,option:e.option,expr:{type:et.ACCESSOR,paths:e.expr.paths.concat({type:et.STRING,value:"length"})}},d={type:ot.SET,option:e.option,expr:r.index},f=e.insertions.length;c(this.childs,function(e,n){t[n].push(h),n>=p+l&&(t[n].push(d),ie.prototype.set.call(e.scope,d.expr,n-l+f,{silence:1}))},this);var g=[p,l],v=[p,l];c(e.insertions,function(e,t){g.push(Ae(this,e,p+t)),v.push([])},this),c(this.childs.splice.apply(this.childs,g),function(e){e.dispose()}),t.splice.apply(t,v)}}else c(t,function(t){t.push(e)});return!n},this),n)this._paintList(),this._toAttached();else for(var i=this.childs.length,s=this;i--;){var a=this.childs[i];a.lifeCycle.is("attached")?t[i].length&&a.updateView(t[i]):a.attach(Te(s),s._getEl()),s=a}},Se.prototype._getEl=function(){return Re(this)};var lt,ht="undefined"!=typeof window;Me.start=function(e){lt=e,Me("san",e)},s(Ie,xe),Ie.prototype._type="san-cmpt",Ie.prototype._callHook=Ie.prototype._toPhase=function(e){ce.prototype._toPhase.call(this,e),"function"==typeof this[e]&&this[e].call(this),Me("comp-"+e,this)},Ie.prototype._toAttached=function(){this._getEl(),ce.prototype._toAttached.call(this)},Ie.prototype.on=function(e,t,n){"function"==typeof t&&(this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push({fn:t,declaration:n}))},Ie.prototype.un=function(e,t){for(var n=this.listeners[e],r=n&&n.length;r--;)t&&t!==n[r].fn||n.splice(r,1)},Ie.prototype.fire=function(e,t){c(this.listeners[e],function(e){e.fn.call(this,t)},this)},Ie.prototype.init=function(e){this.filters=this.filters||this.constructor.filters||{},this.computed=this.computed||this.constructor.computed||{},this.messages=this.messages||this.constructor.messages||{},this.subTag=e.subTag,this._compile();var t=this,n=e.aNode,r=this.constructor.prototype.aNode;if(n){var i={};c(n.childs,function(e){var t="____",n=!e.isText&&e.props.get("slot");n&&(t=n.raw),i[t]||(i[t]=[]),i[t].push(e)}),this.aNode=Y({tagName:r.tagName||n.tagName,givenSlots:i,childs:r.childs,props:r.props,binds:je(n.props),events:r.events,directives:n.directives}),c(n.events,function(n){t.on(n.name,a(me,e.owner,n,1,e.scope),n)})}this._toPhase("compiled"),this.data=new ie(o("function"==typeof this.initData&&this.initData()||{},e.data)),xe.prototype._init.call(this,e),Be(this.binds),this.scope&&this.binds.each(function(e){t.data.set(e.name,t.evalExpr(e.expr))});var s=this.dataTypes||this.constructor.dataTypes;if(s){var u=P(s,this.subTag||this.name||this.constructor.name);this.data.setTypeChecker(u),this.data.checkDataTypes()}this.computedDeps={};for(var p in this.computed)this.computedDeps[p]||this._calcComputed(p);this.dataChanger||(this.dataChanger=a(this._dataChanger,this),this.data.listen(this.dataChanger)),this._toPhase("inited"),this._isInitFromEl&&this._toAttached()},Ie.prototype._initFromEl=function(){this._isInitFromEl=1,this.aNode=Fe(this.el),this.aNode.givenSlots={},this.aNode.binds=je(this.aNode.props),this.aNode.props=this.constructor.prototype.aNode.props,this.parent&&this.parent._pushChildANode(this.aNode),this.tagName=this.aNode.tagName,Ue(this)},Ie.prototype._calcComputed=function(e){var t=this.computedDeps[e];t||(t=this.computedDeps[e]={}),this.data.set(e,this.computed[e].call({data:{get:a(function(n){if(!n)throw new Error("[SAN ERROR] call get method in computed need argument");return t[n]||(t[n]=1,this.computed[n]&&this._calcComputed(n),this.watch(n,function(){this._calcComputed(e)})),this.data.get(n)},this)}}))},Ie.prototype.dispatch=function(e,t){for(var n=this.parentComponent;n;){if("function"==typeof n.messages[e]){n.messages[e].call(n,{target:this,value:t});break}n=n.parentComponent}},Ie.prototype.ref=function(e){function t(e){c(e,function(e){return n(e),!r})}function n(o){t(o.slotChilds),c(o.childs,function(o){if(ae(o)){var s=o.aNode.directives.get("ref");s&&te(s.value,o.scope||i.data,i)===e&&(r=o),t(o.slotChilds)}return!r&&o instanceof xe&&n(o),!r})}var r,i=this;return n(this),t(this.ownSlotChilds),r};var dt=[{name:"class",expr:K("{{class | _class | _sep(' ')}}")},{name:"style",expr:K("{{style | _style | _sep(';')}}")}];Ie.prototype._compile=function(){var e=this.constructor,t=e.prototype;if(!t.hasOwnProperty("_cmptReady")){t.components=e.components||t.components||{};var n=t.components;for(var r in n){var i=n[r];"object"==typeof i?n[r]=Le(i):"self"===i&&(n[r]=e)}t._cmptReady=1}if(!t.hasOwnProperty("_compiled")){t.aNode=Y();var o=e.template||t.template;if(o){var s=Q(o),a=s.childs[0];if(1!==s.childs.length||a.isText)throw new Error("[SAN FATAL] template must have a root element.");t.aNode=a,"template"===a.tagName&&(a.tagName=null),a.binds=new m,c(dt,function(e){var t=a.props.get(e.name);t?(t.expr.segs.push(e.expr.segs[0]),t.expr.value=null):a.props.push({name:e.name,expr:e.expr})})}t._compiled=1}},Ie.prototype.updateView=function(e){if(!this.lifeCycle.is("disposed")){var t=this;c(e,function(e){var n=e.expr;t.binds.each(function(r){var i,o=r.name,s=r.expr;!ve(e,t,o)&&(i=re(n,s,t.scope))&&(i>2&&(o={type:et.ACCESSOR,paths:[{type:et.STRING,value:o}].concat(n.paths.slice(s.paths.length))},s=n),t.data.set(o,t.evalExpr(s),{target:{id:t.owner.id}}))})}),c(this.slotChilds,function(t){xe.prototype.updateChilds.call(t,e)});var n=t.dataChanges;n.length&&(t.dataChanges=[],t.props.each(function(e){c(n,function(n){if(re(n.expr,e.expr,t.data))return t.setProp(e.name,te(e.expr,t.data,t)),!1})}),this.updateChilds(n,"ownSlotChilds"),this._toPhase("updated"),t.owner&&(c(n,function(e){t.binds.each(function(n){var r=e.expr;if(n.x&&!ve(e,t.owner)&&re(r,$(n.name),t.data)){var i=n.expr;r.paths.length>1&&(i={type:et.ACCESSOR,paths:n.expr.paths.concat(r.paths.slice(1))}),t.scope.set(i,te(r,t.data,t),{target:{id:t.id,prop:n.name}})}})}),t.owner.updateView()))}},Ie.prototype._dataChanger=function(e){if(this.lifeCycle.is("painting")||this.lifeCycle.is("created")){var t=this.dataChanges.length;for(t||g(this.updateView,this);t--;)switch(re(e.expr,this.dataChanges[t].expr)){case 1:case 2:e.type===ot.SET&&this.dataChanges.splice(t,1)}this.dataChanges.push(e)}},Ie.prototype.watch=function(e,t){var n=$(e);this.data.listen(a(function(e){re(e.expr,n,this.data)&&t.call(this,te(n,this.data,this),e)},this))},Ie.prototype._dispose=function(){xe.prototype._dispose.call(this),
this.ownSlotChilds=null,this.data.unlisten(),this.dataChanger=null,this.dataChanges=null,this.listeners=null},De.prototype.goNext=function(){this.current=this.raw[++this.index],this.next=this.raw[this.index+1]},s(Ge,ce),Ge.prototype._init=function(e){var t=e.owner,n=Y();if(e.el)0!==e.stumpText.indexOf("!")&&(e.owner=t.owner,e.scope=t.scope,e.stumpText=e.stumpText.slice(1)),this.name=e.stumpText||"____";else{var r=e.aNode.props.get("name");this.name=r?r.raw:"____";var i=t.aNode.givenSlots,o=i&&i[this.name];n.childs=o||e.aNode.childs.slice(0),o&&(e.owner=t.owner,e.scope=t.scope)}e.aNode=n,ce.prototype._init.call(this,e);for(var s=this.parent;s;){if(s===this.owner){s.ownSlotChilds.push(this);break}if(!(s instanceof Ge)&&s.owner===this.owner){s.slotChilds.push(this);break}s=s.parent}if(e.el){for(;;){var a=e.elWalker.next;if(!a||pe(a,"slot")){a&&e.elWalker.goNext();break}var c=be(a,this,e.elWalker);this.childs.push(c),e.elWalker.goNext()}t!==this.owner&&(t.aNode.givenSlots[this.name]=this.aNode)}},Ge.prototype.genHTML=function(e){we(this,e)},Ge.prototype.updateView=i,Ge.prototype._getEl=function(){return this.parent._getEl()},Ge.prototype._dispose=function(){xe.prototype._disposeChilds.call(this),ce.prototype._dispose.call(this)},Ge.prototype._pushChildANode=xe.prototype._pushChildANode;var ft={version:"3.2.3",debug:!0,Component:Ie,defineComponent:Le,parseTemplate:Q,parseExpr:$,ExprType:et,LifeCycle:se,nextTick:g,inherits:s,DataTypes:Ze};t=e.exports=ft,Me.start(ft)}(this)}).call(t,n(3).setImmediate)},function(e,t,n){function r(e,t){this._id=e,this._clearFn=t}var i=Function.prototype.apply;t.setTimeout=function(){return new r(i.call(setTimeout,window,arguments),clearTimeout)},t.setInterval=function(){return new r(i.call(setInterval,window,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(window,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},n(4),t.setImmediate=setImmediate,t.clearImmediate=clearImmediate},function(e,t,n){(function(e,t){!function(e,n){"use strict";function r(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var r={callback:e,args:t};return g[f]=r,d(f),f++}function i(e){delete g[e]}function o(e){var t=e.callback,r=e.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(n,r)}}function s(e){if(v)setTimeout(s,0,e);else{var t=g[e];if(t){v=!0;try{o(t)}finally{i(e),v=!1}}}}function a(){d=function(e){t.nextTick(function(){s(e)})}}function c(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}function u(){var t="setImmediate$"+Math.random()+"$",n=function(n){n.source===e&&"string"==typeof n.data&&0===n.data.indexOf(t)&&s(+n.data.slice(t.length))};e.addEventListener?e.addEventListener("message",n,!1):e.attachEvent("onmessage",n),d=function(n){e.postMessage(t+n,"*")}}function p(){var e=new MessageChannel;e.port1.onmessage=function(e){var t=e.data;s(t)},d=function(t){e.port2.postMessage(t)}}function l(){var e=m.documentElement;d=function(t){var n=m.createElement("script");n.onreadystatechange=function(){s(t),n.onreadystatechange=null,e.removeChild(n),n=null},e.appendChild(n)}}function h(){d=function(e){setTimeout(s,0,e)}}if(!e.setImmediate){var d,f=1,g={},v=!1,m=e.document,y=Object.getPrototypeOf&&Object.getPrototypeOf(e);y=y&&y.setTimeout?y:e,"[object process]"==={}.toString.call(e.process)?a():c()?u():e.MessageChannel?p():m&&"onreadystatechange"in m.createElement("script")?l():h(),y.setImmediate=r,y.clearImmediate=i}}("undefined"==typeof self?"undefined"==typeof e?this:e:self)}).call(t,function(){return this}(),n(5))},function(e,t){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function i(e){if(p===setTimeout)return setTimeout(e,0);if((p===n||!p)&&setTimeout)return p=setTimeout,setTimeout(e,0);try{return p(e,0)}catch(t){try{return p.call(null,e,0)}catch(t){return p.call(this,e,0)}}}function o(e){if(l===clearTimeout)return clearTimeout(e);if((l===r||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(e);try{return l(e)}catch(t){try{return l.call(null,e)}catch(t){return l.call(this,e)}}}function s(){g&&d&&(g=!1,d.length?f=d.concat(f):v=-1,f.length&&a())}function a(){if(!g){var e=i(s);g=!0;for(var t=f.length;t;){for(d=f,f=[];++v<t;)d&&d[v].run();v=-1,t=f.length}d=null,g=!1,o(e)}}function c(e,t){this.fun=e,this.array=t}function u(){}var p,l,h=e.exports={};!function(){try{p="function"==typeof setTimeout?setTimeout:n}catch(e){p=n}try{l="function"==typeof clearTimeout?clearTimeout:r}catch(e){l=r}}();var d,f=[],g=!1,v=-1;h.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];f.push(new c(e,t)),1!==f.length||g||i(a)},c.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=u,h.addListener=u,h.once=u,h.off=u,h.removeListener=u,h.removeAllListeners=u,h.emit=u,h.prependListener=u,h.prependOnceListener=u,h.listeners=function(e){return[]},h.binding=function(e){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(e){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}}]);